import{e2 as H,bL as f}from"./CAD0QkYh.js";var p={};(function(i){Object.defineProperty(i,"__esModule",{value:!0}),i.hmac=i.HMAC=void 0;const a=H,d=f;class r extends d.Hash{constructor(t,h){super(),this.finished=!1,this.destroyed=!1,(0,a.hash)(t);const n=(0,d.toBytes)(h);if(this.iHash=t.create(),typeof this.iHash.update!="function")throw new Error("Expected instance of class which extends utils.Hash");this.blockLen=this.iHash.blockLen,this.outputLen=this.iHash.outputLen;const c=this.blockLen,s=new Uint8Array(c);s.set(n.length>c?t.create().update(n).digest():n);for(let e=0;e<s.length;e++)s[e]^=54;this.iHash.update(s),this.oHash=t.create();for(let e=0;e<s.length;e++)s[e]^=106;this.oHash.update(s),s.fill(0)}update(t){return(0,a.exists)(this),this.iHash.update(t),this}digestInto(t){(0,a.exists)(this),(0,a.bytes)(t,this.outputLen),this.finished=!0,this.iHash.digestInto(t),this.oHash.update(t),this.oHash.digestInto(t),this.destroy()}digest(){const t=new Uint8Array(this.oHash.outputLen);return this.digestInto(t),t}_cloneInto(t){t||(t=Object.create(Object.getPrototypeOf(this),{}));const{oHash:h,iHash:n,finished:c,destroyed:s,blockLen:e,outputLen:l}=this;return t=t,t.finished=c,t.destroyed=s,t.blockLen=e,t.outputLen=l,t.oHash=h._cloneInto(t.oHash),t.iHash=n._cloneInto(t.iHash),t}destroy(){this.destroyed=!0,this.oHash.destroy(),this.iHash.destroy()}}i.HMAC=r;const u=(o,t,h)=>new r(o,t).update(h).digest();i.hmac=u,i.hmac.create=(o,t)=>new r(o,t)})(p);export{p as h};
